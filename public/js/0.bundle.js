webpackJsonp([0],{"/LyW":function(t,e,a){var o=a("Nin2");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("25163a64",o,!0,{})},"96U3":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["categories"],data:function(){return{newCategory:null,formData:{price:null,pck_price:null,pck_units:null,category_id:null,name:null,code:null}}},methods:{valid:function(){var t=this,e=null;if(this.categories.forEach(function(a){var o=a.products.find(function(e){return e.code==t.formData.code});null!=o&&(e=o)}),null==e)return!0;swal("error","ya existe un producto con el codigo"+t.formData.code,"error")},resetForm:function(){this.formData={price:null,category_id:null,name:null,code:null}},save:function(){var t=this;this.valid()&&("new"==this.formData.category_id?null!=this.categories.find(function(e){return e.name.toLowerCase()==t.newCategory.toLowerCase()})?swal("Error","Ya existe la categoria "+t.newCategory,"error"):t.$http.post("/admin/category/",{name:this.newCategory}).then(function(e){var a=e.data;t.formData.category_id=a.id,t.$http.post("/admin/product/",t.formData).then(function(e){t.$emit("productSaved",e.data),swal("Product guardado","","success"),t.resetForm()})}):t.$http.post("/admin/product/",t.formData).then(function(e){t.$emit("productSaved",e.data),swal("Product guardado","","success"),t.resetForm()}))}}}},Bd7W:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t.product.images.length>0?a("img",{attrs:{src:t.product.images[0].url,alt:t.product.name},on:{click:function(e){t.imgModal(t.product)}}}):a("img",{attrs:{src:"/storage/images/app/no-image.png",alt:"no-image"},on:{click:function(e){t.imgModal(t.product)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.product.code,expression:"product.code",modifiers:{lazy:!0}}],staticClass:"nametd",attrs:{type:"text"},domProps:{value:t.product.code},on:{change:[function(e){t.$set(t.product,"code",e.target.value)},function(e){t.saveChange(t.product,"code")}]}})]),t._v(" "),a("td",[a("textarea",{directives:[{name:"model",rawName:"v-model.lazy",value:t.product.name,expression:"product.name",modifiers:{lazy:!0}}],attrs:{rows:"2",placeholder:"Nombre",type:"text"},domProps:{value:t.product.name},on:{change:[function(e){t.$set(t.product,"name",e.target.value)},function(e){t.saveChange(t.product,"name")}]}}),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model.lazy",value:t.product.description,expression:"product.description",modifiers:{lazy:!0}}],attrs:{placeholder:"Descripcion",rows:"3"},domProps:{value:t.product.description},on:{change:[function(e){t.$set(t.product,"description",e.target.value)},function(e){t.saveChange(t.product,"description")}]}})]),t._v(" "),a("td",{staticClass:"text-info text-center"},[t._v(" \n         $"),a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.product.price,expression:"product.price",modifiers:{lazy:!0}}],staticStyle:{width:"80%"},attrs:{type:"number"},domProps:{value:t.product.price},on:{change:[function(e){t.$set(t.product,"price",e.target.value)},function(e){t.saveChange(t.product,"price")}]}}),t._v(" "),a("button",{staticClass:"btn btn-block mt-3",class:{"bg-focus white-bold":t.product.offer},on:{click:function(e){t.toggleOffer(t.product)}}},[t._v("Oferta")])]),t._v(" "),a("td",{staticClass:"d-flex flex-column justify-content-center align-items-center"},[a("button",{staticClass:"btn btn-sm btn-outline-danger m-1",on:{click:function(e){e.preventDefault(),t.deleteProduct(t.product)}}},[a("i",{staticClass:"fa fa-trash"})]),t._v(" "),a("button",{staticClass:"btn btn-sm m-1",class:{"btn-info":!t.product.paused,"btn-success":t.product.paused},on:{click:function(e){e.preventDefault(),t.togglePause(t.product)}}},[a("i",{class:{"fa fa-pause-circle":!t.product.paused,"fa fa-play":t.product.paused}})])]),t._v(" "),t.showModal?a("image-modal",{ref:"modal",attrs:{product:t.product},on:{refresh:function(e){t.$emit("refresh")}}}):t._e()],1)},staticRenderFns:[]}},FziL:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".btn-link[data-v-4124f506]{color:#000}td img[data-v-4124f506]{width:10vw}textarea[data-v-4124f506]{width:100%}input[type=checkbox][data-v-4124f506]{width:25px;margin:0 10px}@media(max-width:600px){.card-body[data-v-4124f506],.card[data-v-4124f506],.container[data-v-4124f506],table[data-v-4124f506]{font-size:.66rem;padding:0}input[data-v-4124f506],td[data-v-4124f506],th[data-v-4124f506]{white-space:nowrap;width:13vw;padding:2px}.form-control[data-v-4124f506]{width:20vw}.nametd[data-v-4124f506]{width:25vw}}",""])},Gagw:function(t,e,a){var o=a("VU/8")(a("gxTt"),a("xiFP"),!1,function(t){a("b0x0")},"data-v-37ebd58c",null);t.exports=o.exports},JAxG:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("xlbC"),r=a.n(o),i=a("aTJZ"),s=a.n(i),n=a("NYxO"),c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o])}return t};e.default={components:{adminCreate:r.a,productRow:s.a},data:function(){return{searchTerm:"",selectedCategory:null,showCreate:!1,variation:0,list:[],product:null,showModal:!1}},watch:{showModal:function(){this.showModal||console.log(this.$refs.modal)}},computed:{categories:function(){return this.$store.getters["categories/getCategories"]},config:function(){return this.$store.getters.getConfig},products:function(){return this.selectedCategory?this.selectedCategory.products:this.searchTerm&&this.searchTerm.trim().length>1?this.searchFilter():void 0}},methods:c({},Object(n.mapActions)({fetchUser:"fetchUser",fetchConfig:"fetchConfig"}),{searchComparision:function(t,e){var a=e.name.toLowerCase().trim();t=t.toLowerCase().trim();var o=e.category.name.toLowerCase().trim(),r=e.code.toLowerCase().trim();return a.indexOf(t)>-1||o.indexOf(t)>-1||r.indexOf(t)>-1},searchFilter:function(){var t=this;this.loading=!0;var e=this.searchTerm.split(" "),a=[];return this.categories.forEach(function(o){o.products.forEach(function(o){var r=!0;e.forEach(function(e){r&&!t.searchComparision(e,o)&&(r=!1)}),r&&a.push(o)})}),this.loading=!1,a},toggleHidePrices:function(){this.config.hide_prices?this.config.hide_prices=0:this.config.hide_prices=1;var t=this;this.$http.put("/admin/config",{field:"hide_prices",value:this.config.hide_prices}).then(function(e){t.fetchConfig})},refresh:function(){var t=this;this.$store.dispatch("categories/fetch"),t.selectedCategory&&setTimeout(function(){t.selectedCategory=t.categories.find(function(e){return e.id==t.selectedCategory.id})},100)}}),created:function(){this.refresh()},filters:{price:function(t){return t.toFixed(2)}}}},K1iZ:function(t,e,a){var o=a("FziL");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("64f206d8",o,!0,{})},KbaG:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("form",{ref:"form",staticClass:"form form-inline row ml-1",on:{submit:function(e){return e.preventDefault(),t.save(e)}}},[a("div",{staticClass:"col-3 row"},[a("label",{staticClass:"col-12",attrs:{for:""}},[t._v("Codigo")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.code,expression:"formData.code",modifiers:{trim:!0}}],staticClass:"col-12",attrs:{required:"",type:"text"},domProps:{value:t.formData.code},on:{input:function(e){e.target.composing||t.$set(t.formData,"code",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),a("div",{staticClass:"col-3 row"},[a("label",{staticClass:"col-12",attrs:{for:""}},[t._v("Categoria")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.category_id,expression:"formData.category_id",modifiers:{trim:!0}}],staticClass:"col-12 form-control",attrs:{required:"",id:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.formData,"category_id",e.target.multiple?a:a[0])}}},[t._l(t.categories,function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                      "+t._s(e.name)+"\n                   ")])}),t._v(" "),a("option",{attrs:{value:"new"}},[t._v("Nueva")])],2),t._v(" "),"new"==t.formData.category_id?a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.newCategory,expression:"newCategory",modifiers:{trim:!0}}],attrs:{placeholder:"Nueva Categoria",type:"text"},domProps:{value:t.newCategory},on:{input:function(e){e.target.composing||(t.newCategory=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}):t._e()]),t._v(" "),a("div",{staticClass:"col-3 row"},[a("label",{staticClass:"col-12",attrs:{for:""}},[t._v("Producto")]),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.name,expression:"formData.name",modifiers:{trim:!0}}],staticClass:"col-12",attrs:{rows:"2",required:"",type:"text"},domProps:{value:t.formData.name},on:{input:function(e){e.target.composing||t.$set(t.formData,"name",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),a("div",{staticClass:"col-3 row"},[a("label",{staticClass:"col-12",attrs:{for:""}},[t._v("Precio")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.price,expression:"formData.price",modifiers:{trim:!0}}],staticClass:"col-12",attrs:{min:"0",step:".01",required:"",type:"number"},domProps:{value:t.formData.price},on:{input:function(e){e.target.composing||t.$set(t.formData,"price",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),a("button",{staticClass:"btn btn-outline-success align-self-end justify-self-end",attrs:{type:"submit"}},[t._v(" GUARDAR ")])])])},staticRenderFns:[]}},Nin2:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".btn-link[data-v-b62c3790]{color:#000}td img[data-v-b62c3790]{width:10vw}textarea[data-v-b62c3790]{width:100%}input[type=checkbox][data-v-b62c3790]{width:25px;margin:0 10px}@media(max-width:600px){.card-body[data-v-b62c3790],.card[data-v-b62c3790],.container[data-v-b62c3790],table[data-v-b62c3790]{font-size:.66rem;padding:0}input[data-v-b62c3790],td[data-v-b62c3790],th[data-v-b62c3790]{white-space:nowrap;width:13vw;padding:2px}.form-control[data-v-b62c3790]{width:20vw}.nametd[data-v-b62c3790]{width:25vw}}",""])},WE0C:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".image-container[data-v-37ebd58c]{position:relative;overflow:hidden}.close-button[data-v-37ebd58c]{position:absolute;bottom:10px;left:50%}.controls[data-v-37ebd58c]{position:absolute;bottom:50%;left:0;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.controls .fa[data-v-37ebd58c]{font-size:2rem;cursor:pointer}.set-first[data-v-37ebd58c]{position:absolute;top:10px;left:50%}",""])},aTJZ:function(t,e,a){var o=a("VU/8")(a("wD9/"),a("Bd7W"),!1,function(t){a("/LyW")},"data-v-b62c3790",null);t.exports=o.exports},b0x0:function(t,e,a){var o=a("WE0C");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("0b9fc827",o,!0,{})},c8UL:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",[a("hr"),t._v(" "),a("h1",[t._v("Administrar Productos")]),t._v(" "),t.config&&!t.config.hide_prices?a("button",{staticClass:"btn btn-lg btn-outline-danger",on:{click:t.toggleHidePrices}},[t._v("\n                Ocultar precios al publico\n            ")]):a("button",{staticClass:"btn btn-lg btn-outline-success",on:{click:t.toggleHidePrices}},[t._v("\n                Mostrar precios al publico\n            ")]),t._v(" "),a("hr"),t._v(" "),a("div",{staticClass:"row w-100"},[a("div",{staticClass:"col-12 col-lg-8"},[a("button",{staticClass:"btn btn-outline-info",on:{click:function(e){t.showCreate=!t.showCreate}}},[t._v("Crear Producto")]),t._v(" "),t.showCreate?a("admin-create",{attrs:{categories:t.categories},on:{productSaved:t.refresh}}):t._e()],1)]),t._v(" "),a("div",{staticClass:"row mt-4 d-flex align-items-start "},[t._m(0),t._v(" "),t.categories&&t.categories.length>0?a("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedCategory,expression:"selectedCategory"}],staticClass:"form-control col-6 col-lg-2",attrs:{type:"text"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.selectedCategory=e.target.multiple?a:a[0]},function(e){t.searchTerm=""}]}},t._l(t.categories,function(e){return a("option",{key:e.name,domProps:{value:e}},[t._v("\n                        "+t._s(e.name)+"\n                    ")])})):t._e(),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.searchTerm,expression:"searchTerm",modifiers:{lazy:!0}}],staticClass:"form-control col-10 col-lg-4 offset-lg-2",attrs:{type:"text",placeholder:"BUSCAR"},domProps:{value:t.searchTerm},on:{change:[function(e){t.searchTerm=e.target.value},function(e){t.selectedCategory=null}]}}),t._v(" "),t._m(1)]),t._v(" "),a("hr"),t._v(" "),t.products?a("div",[a("div",{staticClass:"card flex-wrap"},[a("div",{staticClass:"card-body"},[a("table",{staticClass:"table table-striped table-bordered "},[t._m(2),t._v(" "),t._l(t.products,function(e){return a("productRow",{key:e.name,tag:"tr",attrs:{product:e},on:{refresh:t.refresh}})})],2)])])]):t._e()])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"col-6 col-lg-2 label mt-1"},[e("h4",[this._v(" MOSTRAR ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-outline-info col-1"},[e("i",{staticClass:"fas fa-search"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",{},[e("th",[this._v("imagen")]),this._v(" "),e("th",[this._v("Codigo")]),this._v(" "),e("th",[this._v("Producto")]),this._v(" "),e("th",[this._v("Precio")])])}]}},gxTt:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["product"],data:function(){return{imageUploaded:!1,file:null,i:0,csrf:csrf,show:!0}},watch:{product:function(){this.show=!0,this.preloadImages()}},methods:{preloadImages:function(){if(this.product&&this.product.images&&this.product.images.length>0){var t=[];this.product.images.forEach(function(e){var a=new Image;a.src=e.url,t.push(a)})}},deleteImage:function(t){var e=this;this.$http.delete("/admin/product/image/"+t.id).then(function(){e.product.images.splice(e.i,1),e.$emit("refresh"),e.i=0})},orderChange:function(t,e){t.order=e;var a={id:t.id,field:"order",value:e};this.$http.put("/admin/productImage",a)},closedModal:function(){this.i=0,this.$emit("closedModal"),$("#image-modal").modal("hide")},save:function(t){var e=this,a=$('input[type="file"]')[0].files[0];if(null==a)swal("No se ha seleccionado una imagen","","error");else{this.file=a;var o=new FormData;o.append("image",a),o.append("product",this.product.id),$.ajax({url:"/admin/product/image",type:"post",data:o,cache:!1,contentType:!1,processData:!1,files:!0,success:function(){e.$emit("refresh"),e.closedModal(),e.i=0}})}},changeImage:function(t){"next"==t?(this.i++,this.product.images[this.i]||(this.i=0)):(this.i--,this.i<0&&(this.i=this.product.images.length-1))}}}},"vC/7":function(t,e,a){var o=a("VU/8")(a("JAxG"),a("c8UL"),!1,function(t){a("K1iZ")},"data-v-4124f506",null);t.exports=o.exports},"wD9/":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("Gagw"),r=a.n(o);e.default={props:["product"],components:{imageModal:r.a},data:function(){return{showModal:!1}},methods:{saveChange:function(t,e){"price"==e&&(t.price=t.price.replace(/,/g,"."));var a={product:t.id,field:e,value:t[e]};"paused"==a.field&&(a.value=a.value?1:0),$.ajax({method:"put",data:a,url:"/admin/product"})},deleteProduct:function(t){var e=this;this.$http.delete("/admin/product/"+t.id).then(function(t){e.$emit("refresh")})},imgModal:function(t){var e=this;this.product=t,this.showModal=!0,setTimeout(function(){var t=e.$refs.modal.$el;$(t).modal("show")},100)},toggleOffer:function(t){t.offer=!t.offer;var e={product:t.id,field:"offer",value:t.offer?1:0};$.ajax({method:"put",data:e,url:"/admin/product"})},togglePause:function(t){var e=this;for(var a in t.paused=!t.paused,e.saveChange(t,"paused"),e.categories)if(e.categories.hasOwnProperty(a)){var o=e.categories[a];for(var r in o.products){if(o.products.hasOwnProperty(r))if(o.products[r].id==t.id)return void(e.categories[a].products[r].paused=t.paused)}}}}}},xiFP:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.product?a("div",{ref:"modal",staticClass:"modal fade",attrs:{id:"image-modal",tabindex:"-1",role:"dialog"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[t.product?a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v(" "+t._s(t.product.name)+" ")]),t._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(e){t.closedModal()}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"image-container"},[a("transition",{attrs:{"leave-active-class":" animated slideOutRight faster position-absolute"}},[t.product.images&&t.product.images.length>0?a("img",{key:t.product.images[t.i].id,staticClass:"w-100 ",attrs:{src:t.product.images[t.i].url,alt:t.product.name}}):t._e()]),t._v(" "),!t.product.images||!t.product.images.length>0?a("img",{attrs:{src:"/storage/images/app/no-image.png",alt:t.product.name}}):t._e(),t._v(" "),t.product.images&&t.product.images.length>1?a("div",{staticClass:"controls"},[a("span",{staticClass:"fa fa-chevron-left text-info",on:{click:function(e){t.changeImage("prev")}}}),t._v(" "),a("span",{staticClass:"fa fa-chevron-right text-info",on:{click:function(e){t.changeImage("next")}}})]):t._e(),t._v(" "),t.product.images[0]?a("button",{staticClass:"btn btn-sm btn-danger close-button",on:{click:function(e){e.preventDefault(),t.deleteImage(t.product.images[t.i])}}},[t._v("X")]):t._e(),t._v(" "),t.product.images.length>1?a("div",{staticClass:"order-select"},t._l(t.product.images.length,function(e){return a("label",{key:e,staticClass:"btn btn-sm",class:{"btn-success":t.product.images[t.i].order==e,"btn-outline-info":t.product.images[t.i].order!=e},on:{click:function(a){t.orderChange(t.product.images[t.i],e)}}},[t._v("\n                        "+t._s(e)+"\n                    ")])})):t._e()],1),t._v(" "),a("form",{attrs:{enctype:"multipart/form-data",name:"uploader"}},[a("input",{attrs:{type:"hidden",name:"_token"},domProps:{value:t.csrf}}),t._v(" "),a("div",{staticClass:"d-flex flex-column"},[a("label",{staticClass:"text-info text-center"},[t._v("  \n                        Subir una imagen   \n                    ")]),t._v(" "),a("input",{staticClass:"display-none",attrs:{type:"file",name:"file",accept:"image/x-png,image/gif,image/jpeg"},on:{change:function(e){t.imageUploaded=!0}}})])])]),t._v(" "),a("div",{staticClass:"modal-footer"},[t.imageUploaded?a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.save(e)}}},[t._v("Guardar")]):t._e(),t._v(" "),a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Cerrar")])])]):t._e()])]):t._e()},staticRenderFns:[]}},xlbC:function(t,e,a){var o=a("VU/8")(a("96U3"),a("KbaG"),!1,null,null,null);t.exports=o.exports}});